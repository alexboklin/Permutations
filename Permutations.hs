permute :: [a] -> [[a]]

--rotateList constructs "rotations" of a list, e.g.:
--GHCi> rotateList [1,2,3,4]
--[[1,2,3,4],[2,3,4,1],[3,4,1,2],[4,1,2,3]]
rotateList x = rotateList' x [] 0 where
	rotateList' src dst n
		| n == length x = dst
		| otherwise = rotateList' (tail src ++ [head src]) (dst ++ [src]) (n + 1)

-- rotateTail 0 [1,2,3,4]: [[1,2,3,4],[2,3,4,1],[3,4,1,2],[4,1,2,3]], like rotateList
-- rotateTail 1 [1,2,3,4]: [[1,2,3,4],[1,3,4,2],[1,4,2,3]]
-- rotateTail 2 [1,2,3,4]: [[1,2,3,4],[1,2,4,3]]
rotateTail n lst = [  take n lst ++ x | x <- rotateList $ drop n lst ]

-- Formula: map $ rotateTail n + 1 $ rotateTail n element from rotate input
-- Condition: length input - 2 > 1, only one rotation for the last element

permute lst = permute' (rotateTail 0 lst) 1 where
	permute' src counter
		| length lst - counter == 1 = src
		| otherwise = permute' (concat $ map (rotateTail counter) $ src) (counter + 1)

--length $ permute [1,2,3,4] = 24

--concat $ map (rotateTail 2) $ concat $ map (rotateTail 1) $ rotateTail 0 [1,2,3,4]:
--[
--[1,2,3,4],[1,2,4,3],[1,3,4,2],[1,3,2,4],[1,4,2,3],[1,4,3,2],
--[2,3,4,1],[2,3,1,4],[2,4,1,3],[2,4,3,1],[2,1,3,4],[2,1,4,3],
--[3,4,1,2],[3,4,2,1],[3,1,2,4],[3,1,4,2],[3,2,4,1],[3,2,1,4],
--[4,1,2,3],[4,1,3,2],[4,2,3,1],[4,2,1,3],[4,3,1,2],[4,3,2,1]
--]

--length $ permute [1,2,3,4,5] = 120

--concat $ map (rotateTail 3) $ concat $ map (rotateTail 2) $ concat $ map (rotateTail 1) $ rotateTail 0 [1,2,3,4,5]
--[
--[1,2,3,4,5],[1,2,3,5,4],[1,2,4,5,3],[1,2,4,3,5],[1,2,5,3,4],[1,2,5,4,3],
--[1,3,4,5,2],[1,3,4,2,5],[1,3,5,2,4],[1,3,5,4,2],[1,3,2,4,5],[1,3,2,5,4],
--[1,4,5,2,3],[1,4,5,3,2],[1,4,2,3,5],[1,4,2,5,3],[1,4,3,5,2],[1,4,3,2,5],
--[1,5,2,3,4],[1,5,2,4,3],[1,5,3,4,2],[1,5,3,2,4],[1,5,4,2,3],[1,5,4,3,2],
--[2,3,4,5,1],[2,3,4,1,5],[2,3,5,1,4],[2,3,5,4,1],[2,3,1,4,5],[2,3,1,5,4],
--[2,4,5,1,3],[2,4,5,3,1],[2,4,1,3,5],[2,4,1,5,3],[2,4,3,5,1],[2,4,3,1,5],
--[2,5,1,3,4],[2,5,1,4,3],[2,5,3,4,1],[2,5,3,1,4],[2,5,4,1,3],[2,5,4,3,1],
--[2,1,3,4,5],[2,1,3,5,4],[2,1,4,5,3],[2,1,4,3,5],[2,1,5,3,4],[2,1,5,4,3],
--[3,4,5,1,2],[3,4,5,2,1],[3,4,1,2,5],[3,4,1,5,2],[3,4,2,5,1],[3,4,2,1,5],
--[3,5,1,2,4],[3,5,1,4,2],[3,5,2,4,1],[3,5,2,1,4],[3,5,4,1,2],[3,5,4,2,1],
--[3,1,2,4,5],[3,1,2,5,4],[3,1,4,5,2],[3,1,4,2,5],[3,1,5,2,4],[3,1,5,4,2],
--[3,2,4,5,1],[3,2,4,1,5],[3,2,5,1,4],[3,2,5,4,1],[3,2,1,4,5],[3,2,1,5,4],
--[4,5,1,2,3],[4,5,1,3,2],[4,5,2,3,1],[4,5,2,1,3],[4,5,3,1,2],[4,5,3,2,1],
--[4,1,2,3,5],[4,1,2,5,3],[4,1,3,5,2],[4,1,3,2,5],[4,1,5,2,3],[4,1,5,3,2],
--[4,2,3,5,1],[4,2,3,1,5],[4,2,5,1,3],[4,2,5,3,1],[4,2,1,3,5],[4,2,1,5,3],
--[4,3,5,1,2],[4,3,5,2,1],[4,3,1,2,5],[4,3,1,5,2],[4,3,2,5,1],[4,3,2,1,5],
--[5,1,2,3,4],[5,1,2,4,3],[5,1,3,4,2],[5,1,3,2,4],[5,1,4,2,3],[5,1,4,3,2],
--[5,2,3,4,1],[5,2,3,1,4],[5,2,4,1,3],[5,2,4,3,1],[5,2,1,3,4],[5,2,1,4,3],
--[5,3,4,1,2],[5,3,4,2,1],[5,3,1,2,4],[5,3,1,4,2],[5,3,2,4,1],[5,3,2,1,4],
--[5,4,1,2,3],[5,4,1,3,2],[5,4,2,3,1],[5,4,2,1,3],[5,4,3,1,2],[5,4,3,2,1]
--]
